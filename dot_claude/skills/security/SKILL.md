---
name: security
description: mainブランチとのgit diffをセキュリティ観点でレビューする。機密情報漏洩・脆弱性・インジェクション等を検査する。
---

# セキュリティレビュー

## 手順

以下のBashコマンドでコンテキストを収集してから分析を行う:

```bash
# 現在のブランチ
git branch --show-current

# 変更ファイル一覧
git diff --name-only main

# 全差分
git diff main
```

## チェック項目

### 1. シークレット・認証情報
- ハードコードされたAPIキー・トークン・パスワード
- 秘密鍵・証明書
- 認証情報を含む接続文字列
- 機密設定値（1Password参照の露出含む）

### 2. インジェクション脆弱性
- SQLインジェクション
- コマンドインジェクション
- XSS（クロスサイトスクリプティング）
- コードインジェクション・eval使用

### 3. 認証・認可
- アクセス制御の不備
- 認証チェックの欠落
- 安全でないセッション管理
- 権限昇格リスク

### 4. データ露出
- ログへの機密データ出力
- 暗号化されていない機密データ
- APIレスポンスの過剰なデータ露出
- PII（個人識別情報）の不適切な扱い

### 5. 入力バリデーション
- バリデーションの欠落・不十分
- パストラバーサル脆弱性
- 安全でないデシリアライゼーション
- ファイルアップロードの脆弱性

### 6. 依存関係・設定
- 既知の脆弱な依存関係
- 安全でないデフォルト設定
- セキュリティヘッダーの欠落
- 過度に許可的なCORS設定

## アウトプット形式

問題が見つかった場合、各項目を以下の形式で報告:

- **深刻度**: Critical / High / Medium / Low
- **場所**: ファイルと行番号
- **問題**: 脆弱性の説明
- **推奨対応**: 修正方法

問題が見つからない場合は、変更が安全であることを確認して報告する。
