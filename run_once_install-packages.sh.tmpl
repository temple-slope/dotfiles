#!/bin/bash

set -e

echo "ğŸ“¦ ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚’å®Ÿè¡Œã—ã¾ã™ã‹ï¼Ÿ (y/N)"
read -r answer
if [[ "$answer" != "y" && "$answer" != "Y" ]]; then
  echo "â­ ã‚¹ã‚­ãƒƒãƒ—ã—ã¾ã—ãŸã€‚"
  exit 0
fi

echo "ğŸ” å®Ÿè¡Œç’°å¢ƒ: {{ .chezmoi.hostname }}"

# HomebrewãŒãªã‘ã‚Œã°ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
if ! command -v brew >/dev/null 2>&1; then
  echo "ğŸº Homebrew ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™..."
  NONINTERACTIVE=1 /bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"
fi

# M1/M2 Macå¯¾å¿œã®brewãƒ‘ã‚¹åæ˜ 
eval "$(/opt/homebrew/bin/brew shellenv)"

# Brewfileã‚’é©ç”¨ï¼ˆ--no-lock ã¯å‰Šé™¤ï¼‰
echo "ğŸ“„ Brewfile ã‚’é©ç”¨ä¸­..."
brew bundle --file="{{ joinPath .chezmoi.sourceDir "Brewfile" }}"
